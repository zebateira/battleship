\begin{vdm_al}
class Board
 types
  public Houses = set of House;
 values
  public static BOARD_SIZE: int = 10;
  
  public static MISS : int = 0;
  public static HIT : int = 1;
  public static SHIP_SUNK : int = 2;
 
 instance variables
  
  public playable: bool;
  public houses: Houses := {};
  
  inv card(houses) >= 1;
  
 operations
 
  public Board: bool ==> Board
   Board(t) == 
   (
    playable := t;
    
    for all x in set {1, ..., BOARD_SIZE}  do (
     for all y in set {1, ..., BOARD_SIZE} do (
      houses := houses union {new House(x,y)};
     )
    );
    
    for all h1 in set houses do h1.setBoard(self);
   )
  post card(houses) = BOARD_SIZE * BOARD_SIZE;
  
  -- returns:
  --0 => miss or already hit
  --1 => hit
  --2 => ship sunk
  public hit : seq of int ==> int
   hit(coords) ==
   (
    let h in set houses be st (h.x = coords(House`X) and h.y = coords(House`Y)) in (
     if not h.hasShip or h.hit then return MISS
     elseif h.hasShip then
      (
       h.ship.inc();
       h.hit := true;
       if not h.ship.isDown() then return HIT
       else return SHIP_SUNK;
      )
     else (*@\notcovered{return}@*) (*@\notcovered{MISS}@*);
    );
   )
   pre House`checkCoords(coords)   
   post RESULT in set {MISS, HIT, SHIP_SUNK};

  public mark : seq of int * int ==> ()
   mark(coords, res) ==
   (
    let h in set houses be st h.x = coords(House`X) and h.y = coords(House`Y) in (
     h.hit := true;
     if res = HIT or res = SHIP_SUNK then
      h.hasShip := true;
    );
   )
   pre House`checkCoords(coords);       
end Board
\end{vdm_al}
\bigskip
\begin{longtable}{|l|r|r|}
\hline
Function or operation & Coverage & Calls \\
\hline
\hline
Board & 100.0\% & 4 \\
\hline
hit & 95.7\% & 199 \\
\hline
mark & 100.0\% & 199 \\
\hline
\hline
Board.vdmpp & 98.1\% & 402 \\
\hline
\end{longtable}

